<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Task Manager</title>
    <link rel="stylesheet" href="styles.css" />
</head>
<body>
<h1>Task Manager</h1>

<div class="toolbar" style="margin-bottom:10px;">
    <button id="btnViewAll" class="btn btn-primary">All</button>
    <button id="btnViewTasks" class="btn">All Tasks</button>
    <button id="btnViewEpics" class="btn">All Epics</button>
    <button id="btnViewSubTasks" class="btn">All SubTasks</button>
</div>

<div id="msg"></div>

<div class="grid">
    <div>
        <div class="table-wrap">
            <table id="taskTable">
                <thead>
                <tr>
                    <th style="width:110px;">Type</th>
                    <th style="width:80px;">ID</th>
                    <th>Name</th>
                    <th style="width:140px;">Status</th>
                    <th style="width:210px;">Start</th>
                    <th style="width:140px;">Duration</th>
                    <th style="width:130px;">Relation</th>
                    <th style="width:110px; text-align:right;">Actions</th>
                </tr>
                </thead>
                <tbody id="taskTbody">
                <tr><td class="empty" colspan="8">Choose a filter or add the first task</td></tr>
                </tbody>
            </table>
        </div>
        <div class="hint">Time is formatted by locale (en-US), duration â€” in minutes/hours.</div>
    </div>

    <form id="taskForm" class="card">
        <h3>Add</h3>

        <label>Type</label>
        <select id="itemType">
            <option value="TASK">Task</option>
            <option value="EPIC">Epic</option>
            <option value="SUBTASK">SubTask</option>
        </select>

        <label>Name</label>
        <input type="text" id="name" required />

        <label>Description</label>
        <input type="text" id="desc" required />

        <div id="epicIdWrap" style="display:none;">
            <label>Epic ID (for SubTask)</label>
            <input type="number" id="epicId" min="0" />
        </div>

        <div id="timingWrap">
            <label>Status</label>
            <select id="status">
                <option value="NEW">NEW</option>
                <option value="IN_PROGRESS">IN_PROGRESS</option>
                <option value="DONE">DONE</option>
            </select>

            <div class="row">
                <div>
                    <label>Duration (minutes)</label>
                    <input type="number" id="duration" value="30" min="0" />
                </div>
                <div>
                    <label>Start</label>
                    <input type="datetime-local" id="start" />
                </div>
            </div>
        </div>

        <button type="submit" class="btn btn-primary" style="margin-top:12px; width:100%;">Add</button>
    </form>
</div>

<!-- Edit modal -->
<div id="editModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.35);">
    <div style="background:#0b121a; border:1px solid var(--border); max-width:460px; margin:6% auto; padding:16px; border-radius:14px; color:var(--text); box-shadow:var(--shadow)">
        <h3 id="editTitle" style="margin-top:0;">Edit</h3>

        <input type="hidden" id="editId">
        <input type="hidden" id="editType"> <!-- TASK | SUBTASK -->

        <label>Name
            <input id="editName" type="text" required>
        </label>

        <label>Description
            <input id="editDesc" type="text" required>
        </label>

        <label>Status
            <select id="editStatus">
                <option value="NEW">NEW</option>
                <option value="IN_PROGRESS">IN_PROGRESS</option>
                <option value="DONE">DONE</option>
            </select>
        </label>

        <label>Duration (min)
            <input id="editDuration" type="number" min="0" value="30">
        </label>

        <label>Start
            <input id="editStart" type="datetime-local">
        </label>

        <div id="editEpicRow" style="display:none;">
            <label>Epic ID
                <input id="editEpicId" type="number" min="0">
            </label>
        </div>

        <div style="margin-top:10px; display:flex; gap:8px; justify-content:flex-end;">
            <button class="btn btn-primary" onclick="submitEdit()">Save</button>
            <button class="btn" onclick="closeEdit()" type="button">Cancel</button>
        </div>
    </div>
</div>

<script src="app.js" defer></script>
</body>
</html>